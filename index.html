<!doctype html>
<html>
<head>
<title>Assignment 1</title>
<style>
    td {
        padding: 5px;
    }
    table {
        background: rgb(101, 205, 228);
    }


</style>
</head>
<body>

<h2>Singapore PSI table</h2>
<h4>Data retrieved at: <span id="timestring"></span></h4>
<table id="PSItable">
    <tr>
        <th>Metric</th>
        <th>National</th>
        <th>Central</th>
        <th>West</th>
        <th>East</th>
        <th>North</th>
        <th>South</th>
    </tr>
</table>

<script>

const addTd = (text, tr) => {
    const td = document.createElement('td')
    td.textContent = text
    tr.appendChild(td)
}

fetch('https://api.data.gov.sg/v1/environment/psi')
  .then(response => response.json())
  .then(data => {
    const table = document.querySelector('#PSItable')
    const readings = data.items[0].readings
    console.log(readings)

    for (const metric in readings) {
        const row = document.createElement('tr')
        table.appendChild(row)

        addTd(metric, row)

        for (const field of ['national', 'central', 'west', 'east', 'north', 'south'])
            addTd(readings[metric][field], row)
    }
  
    let timestamp = data.items[0].update_timestamp;
    console.log(timestamp);
    console.log(readings);
    
    document.querySelector("#timestring").textContent = timestamp;
  
  });


</script>
</body>
</html>